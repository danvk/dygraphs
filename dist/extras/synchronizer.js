"use strict";

/**
 * @license
 * Part of dygraphs, see top-level LICENSE.txt file
 * MIT-licenced: https://opensource.org/licenses/MIT
 */
/**
 * Synchronize zooming and/or selections between a set of dygraphs.
 *
 * Usage:
 *
 *   var g1 = new Dygraph(...),
 *       g2 = new Dygraph(...),
 *       ...;
 *   var sync = Dygraph.synchronize(g1, g2, ...);
 *   // charts are now synchronized
 *   sync.detach();
 *   // charts are no longer synchronized
 *
 * You can set options using the last parameter, for example:
 *
 *   var sync = Dygraph.synchronize(g1, g2, g3, {
 *      selection: true,
 *      zoom: true
 *   });
 *
 * The default is to synchronize both of these.
 *
 * Instead of passing one Dygraph object as each parameter, you may also pass an
 * array of dygraphs:
 *
 *   var sync = Dygraph.synchronize([g1, g2, g3], {
 *      selection: false,
 *      zoom: true
 *   });
 *
 * You may also set `range: false` if you wish to only sync the x-axis.
 * The `range` option has no effect unless `zoom` is true (the default).
 */
(function () {
  /* global Dygraph:false */
  'use strict';

  var Dygraph;
  if (window.Dygraph) {
    Dygraph = window.Dygraph;
  } else if (typeof module !== 'undefined') {
    Dygraph = require('../dygraph');
  }
  var synchronize = function synchronize( /* dygraphs..., opts */
  ) {
    if (arguments.length === 0) {
      throw 'Invalid invocation of Dygraph.synchronize(). Need >= 1 argument.';
    }
    var OPTIONS = ['selection', 'zoom', 'range'];
    var opts = {
      selection: true,
      zoom: true,
      range: true
    };
    var dygraphs = [];
    var prevCallbacks = [];
    var parseOpts = function parseOpts(obj) {
      if (!(obj instanceof Object)) {
        throw 'Last argument must be either Dygraph or Object.';
      } else {
        for (var i = 0; i < OPTIONS.length; i++) {
          var optName = OPTIONS[i];
          if (obj.hasOwnProperty(optName)) opts[optName] = obj[optName];
        }
      }
    };
    if (arguments[0] instanceof Dygraph) {
      // Arguments are Dygraph objects.
      for (var i = 0; i < arguments.length; i++) {
        if (arguments[i] instanceof Dygraph) {
          dygraphs.push(arguments[i]);
        } else {
          break;
        }
      }
      if (i < arguments.length - 1) {
        throw 'Invalid invocation of Dygraph.synchronize(). ' + 'All but the last argument must be Dygraph objects.';
      } else if (i == arguments.length - 1) {
        parseOpts(arguments[arguments.length - 1]);
      }
    } else if (arguments[0].length) {
      // Invoked w/ list of dygraphs, options
      for (var i = 0; i < arguments[0].length; i++) {
        dygraphs.push(arguments[0][i]);
      }
      if (arguments.length == 2) {
        parseOpts(arguments[1]);
      } else if (arguments.length > 2) {
        throw 'Invalid invocation of Dygraph.synchronize(). ' + 'Expected two arguments: array and optional options argument.';
      } // otherwise arguments.length == 1, which is fine.
    } else {
      throw 'Invalid invocation of Dygraph.synchronize(). ' + 'First parameter must be either Dygraph or list of Dygraphs.';
    }
    if (dygraphs.length < 2) {
      throw 'Invalid invocation of Dygraph.synchronize(). ' + 'Need two or more dygraphs to synchronize.';
    }
    var readycount = dygraphs.length;
    for (var i = 0; i < dygraphs.length; i++) {
      var g = dygraphs[i];
      g.ready(function () {
        if (--readycount == 0) {
          // store original callbacks
          var callBackTypes = ['drawCallback', 'highlightCallback', 'unhighlightCallback'];
          for (var j = 0; j < dygraphs.length; j++) {
            if (!prevCallbacks[j]) {
              prevCallbacks[j] = {};
            }
            for (var k = callBackTypes.length - 1; k >= 0; k--) {
              prevCallbacks[j][callBackTypes[k]] = dygraphs[j].getFunctionOption(callBackTypes[k]);
            }
          }

          // Listen for draw, highlight, unhighlight callbacks.
          if (opts.zoom) {
            attachZoomHandlers(dygraphs, opts, prevCallbacks);
          }
          if (opts.selection) {
            attachSelectionHandlers(dygraphs, prevCallbacks);
          }
        }
      });
    }
    return {
      detach: function detach() {
        for (var i = 0; i < dygraphs.length; i++) {
          var g = dygraphs[i];
          if (opts.zoom) {
            g.updateOptions({
              drawCallback: prevCallbacks[i].drawCallback
            });
          }
          if (opts.selection) {
            g.updateOptions({
              highlightCallback: prevCallbacks[i].highlightCallback,
              unhighlightCallback: prevCallbacks[i].unhighlightCallback
            });
          }
        }
        // release references & make subsequent calls throw.
        dygraphs = null;
        opts = null;
        prevCallbacks = null;
      }
    };
  };
  function arraysAreEqual(a, b) {
    if (!Array.isArray(a) || !Array.isArray(b)) return false;
    var i = a.length;
    if (i !== b.length) return false;
    while (i--) {
      if (a[i] !== b[i]) return false;
    }
    return true;
  }
  function attachZoomHandlers(gs, syncOpts, prevCallbacks) {
    var block = false;
    for (var i = 0; i < gs.length; i++) {
      var g = gs[i];
      g.updateOptions({
        drawCallback: function drawCallback(me, initial) {
          if (block || initial) {
            // call the userâ€™s drawCallback even if we are blocked
            for (var j = 0; j < gs.length; j++) {
              if (gs[j] == me) {
                if (prevCallbacks[j] && prevCallbacks[j].drawCallback) {
                  prevCallbacks[j].drawCallback.apply(this, arguments);
                }
                break;
              }
            }
            return;
          }
          block = true;
          var opts = {
            dateWindow: me.xAxisRange()
          };
          if (syncOpts.range) opts.valueRange = me.yAxisRange();
          for (var _j = 0; _j < gs.length; _j++) {
            if (gs[_j] == me) {
              if (prevCallbacks[_j] && prevCallbacks[_j].drawCallback) {
                prevCallbacks[_j].drawCallback.apply(this, arguments);
              }
              continue;
            }

            // Only redraw if there are new options
            if (arraysAreEqual(opts.dateWindow, gs[_j].getOption('dateWindow')) && (!syncOpts.range || arraysAreEqual(opts.valueRange, gs[_j].getOption('valueRange')))) {
              continue;
            }
            gs[_j].updateOptions(opts);
          }
          block = false;
        }
      }, true /* no need to redraw */);
    }
  }

  function attachSelectionHandlers(gs, prevCallbacks) {
    var block = false;
    for (var i = 0; i < gs.length; i++) {
      var g = gs[i];
      g.updateOptions({
        highlightCallback: function highlightCallback(event, x, points, row, seriesName) {
          if (block) return;
          block = true;
          var me = this;
          for (var i = 0; i < gs.length; i++) {
            if (me == gs[i]) {
              if (prevCallbacks[i] && prevCallbacks[i].highlightCallback) {
                prevCallbacks[i].highlightCallback.apply(this, arguments);
              }
              continue;
            }
            var idx = gs[i].getRowForX(x);
            if (idx !== null) {
              gs[i].setSelection(idx, seriesName, undefined, true);
            }
          }
          block = false;
        },
        unhighlightCallback: function unhighlightCallback(event) {
          if (block) return;
          block = true;
          var me = this;
          for (var i = 0; i < gs.length; i++) {
            if (me == gs[i]) {
              if (prevCallbacks[i] && prevCallbacks[i].unhighlightCallback) {
                prevCallbacks[i].unhighlightCallback.apply(this, arguments);
              }
              continue;
            }
            gs[i].clearSelection();
          }
          block = false;
        }
      }, true /* no need to redraw */);
    }
  }

  Dygraph.synchronize = synchronize;
})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJEeWdyYXBoIiwid2luZG93IiwibW9kdWxlIiwicmVxdWlyZSIsInN5bmNocm9uaXplIiwiYXJndW1lbnRzIiwibGVuZ3RoIiwiT1BUSU9OUyIsIm9wdHMiLCJzZWxlY3Rpb24iLCJ6b29tIiwicmFuZ2UiLCJkeWdyYXBocyIsInByZXZDYWxsYmFja3MiLCJwYXJzZU9wdHMiLCJvYmoiLCJPYmplY3QiLCJpIiwib3B0TmFtZSIsImhhc093blByb3BlcnR5IiwicHVzaCIsInJlYWR5Y291bnQiLCJnIiwicmVhZHkiLCJjYWxsQmFja1R5cGVzIiwiaiIsImsiLCJnZXRGdW5jdGlvbk9wdGlvbiIsImF0dGFjaFpvb21IYW5kbGVycyIsImF0dGFjaFNlbGVjdGlvbkhhbmRsZXJzIiwiZGV0YWNoIiwidXBkYXRlT3B0aW9ucyIsImRyYXdDYWxsYmFjayIsImhpZ2hsaWdodENhbGxiYWNrIiwidW5oaWdobGlnaHRDYWxsYmFjayIsImFycmF5c0FyZUVxdWFsIiwiYSIsImIiLCJBcnJheSIsImlzQXJyYXkiLCJncyIsInN5bmNPcHRzIiwiYmxvY2siLCJtZSIsImluaXRpYWwiLCJhcHBseSIsImRhdGVXaW5kb3ciLCJ4QXhpc1JhbmdlIiwidmFsdWVSYW5nZSIsInlBeGlzUmFuZ2UiLCJnZXRPcHRpb24iLCJldmVudCIsIngiLCJwb2ludHMiLCJyb3ciLCJzZXJpZXNOYW1lIiwiaWR4IiwiZ2V0Um93Rm9yWCIsInNldFNlbGVjdGlvbiIsInVuZGVmaW5lZCIsImNsZWFyU2VsZWN0aW9uIl0sInNvdXJjZXMiOlsiLi4vLi4vc3JjL2V4dHJhcy9zeW5jaHJvbml6ZXIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBAbGljZW5zZVxuICogUGFydCBvZiBkeWdyYXBocywgc2VlIHRvcC1sZXZlbCBMSUNFTlNFLnR4dCBmaWxlXG4gKiBNSVQtbGljZW5jZWQ6IGh0dHBzOi8vb3BlbnNvdXJjZS5vcmcvbGljZW5zZXMvTUlUXG4gKi9cbi8qKlxuICogU3luY2hyb25pemUgem9vbWluZyBhbmQvb3Igc2VsZWN0aW9ucyBiZXR3ZWVuIGEgc2V0IG9mIGR5Z3JhcGhzLlxuICpcbiAqIFVzYWdlOlxuICpcbiAqICAgdmFyIGcxID0gbmV3IER5Z3JhcGgoLi4uKSxcbiAqICAgICAgIGcyID0gbmV3IER5Z3JhcGgoLi4uKSxcbiAqICAgICAgIC4uLjtcbiAqICAgdmFyIHN5bmMgPSBEeWdyYXBoLnN5bmNocm9uaXplKGcxLCBnMiwgLi4uKTtcbiAqICAgLy8gY2hhcnRzIGFyZSBub3cgc3luY2hyb25pemVkXG4gKiAgIHN5bmMuZGV0YWNoKCk7XG4gKiAgIC8vIGNoYXJ0cyBhcmUgbm8gbG9uZ2VyIHN5bmNocm9uaXplZFxuICpcbiAqIFlvdSBjYW4gc2V0IG9wdGlvbnMgdXNpbmcgdGhlIGxhc3QgcGFyYW1ldGVyLCBmb3IgZXhhbXBsZTpcbiAqXG4gKiAgIHZhciBzeW5jID0gRHlncmFwaC5zeW5jaHJvbml6ZShnMSwgZzIsIGczLCB7XG4gKiAgICAgIHNlbGVjdGlvbjogdHJ1ZSxcbiAqICAgICAgem9vbTogdHJ1ZVxuICogICB9KTtcbiAqXG4gKiBUaGUgZGVmYXVsdCBpcyB0byBzeW5jaHJvbml6ZSBib3RoIG9mIHRoZXNlLlxuICpcbiAqIEluc3RlYWQgb2YgcGFzc2luZyBvbmUgRHlncmFwaCBvYmplY3QgYXMgZWFjaCBwYXJhbWV0ZXIsIHlvdSBtYXkgYWxzbyBwYXNzIGFuXG4gKiBhcnJheSBvZiBkeWdyYXBoczpcbiAqXG4gKiAgIHZhciBzeW5jID0gRHlncmFwaC5zeW5jaHJvbml6ZShbZzEsIGcyLCBnM10sIHtcbiAqICAgICAgc2VsZWN0aW9uOiBmYWxzZSxcbiAqICAgICAgem9vbTogdHJ1ZVxuICogICB9KTtcbiAqXG4gKiBZb3UgbWF5IGFsc28gc2V0IGByYW5nZTogZmFsc2VgIGlmIHlvdSB3aXNoIHRvIG9ubHkgc3luYyB0aGUgeC1heGlzLlxuICogVGhlIGByYW5nZWAgb3B0aW9uIGhhcyBubyBlZmZlY3QgdW5sZXNzIGB6b29tYCBpcyB0cnVlICh0aGUgZGVmYXVsdCkuXG4gKi9cbihmdW5jdGlvbigpIHtcbi8qIGdsb2JhbCBEeWdyYXBoOmZhbHNlICovXG4ndXNlIHN0cmljdCc7XG5cbnZhciBEeWdyYXBoO1xuaWYgKHdpbmRvdy5EeWdyYXBoKSB7XG4gIER5Z3JhcGggPSB3aW5kb3cuRHlncmFwaDtcbn0gZWxzZSBpZiAodHlwZW9mKG1vZHVsZSkgIT09ICd1bmRlZmluZWQnKSB7XG4gIER5Z3JhcGggPSByZXF1aXJlKCcuLi9keWdyYXBoJyk7XG59XG5cbnZhciBzeW5jaHJvbml6ZSA9IGZ1bmN0aW9uKC8qIGR5Z3JhcGhzLi4uLCBvcHRzICovKSB7XG4gIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAwKSB7XG4gICAgdGhyb3cgJ0ludmFsaWQgaW52b2NhdGlvbiBvZiBEeWdyYXBoLnN5bmNocm9uaXplKCkuIE5lZWQgPj0gMSBhcmd1bWVudC4nO1xuICB9XG5cbiAgdmFyIE9QVElPTlMgPSBbJ3NlbGVjdGlvbicsICd6b29tJywgJ3JhbmdlJ107XG4gIHZhciBvcHRzID0ge1xuICAgIHNlbGVjdGlvbjogdHJ1ZSxcbiAgICB6b29tOiB0cnVlLFxuICAgIHJhbmdlOiB0cnVlXG4gIH07XG4gIHZhciBkeWdyYXBocyA9IFtdO1xuICB2YXIgcHJldkNhbGxiYWNrcyA9IFtdO1xuXG4gIHZhciBwYXJzZU9wdHMgPSBmdW5jdGlvbihvYmopIHtcbiAgICBpZiAoIShvYmogaW5zdGFuY2VvZiBPYmplY3QpKSB7XG4gICAgICB0aHJvdyAnTGFzdCBhcmd1bWVudCBtdXN0IGJlIGVpdGhlciBEeWdyYXBoIG9yIE9iamVjdC4nO1xuICAgIH0gZWxzZSB7XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IE9QVElPTlMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgdmFyIG9wdE5hbWUgPSBPUFRJT05TW2ldO1xuICAgICAgICBpZiAob2JqLmhhc093blByb3BlcnR5KG9wdE5hbWUpKSBvcHRzW29wdE5hbWVdID0gb2JqW29wdE5hbWVdO1xuICAgICAgfVxuICAgIH1cbiAgfTtcblxuICBpZiAoYXJndW1lbnRzWzBdIGluc3RhbmNlb2YgRHlncmFwaCkge1xuICAgIC8vIEFyZ3VtZW50cyBhcmUgRHlncmFwaCBvYmplY3RzLlxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBpZiAoYXJndW1lbnRzW2ldIGluc3RhbmNlb2YgRHlncmFwaCkge1xuICAgICAgICBkeWdyYXBocy5wdXNoKGFyZ3VtZW50c1tpXSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKGkgPCBhcmd1bWVudHMubGVuZ3RoIC0gMSkge1xuICAgICAgdGhyb3cgJ0ludmFsaWQgaW52b2NhdGlvbiBvZiBEeWdyYXBoLnN5bmNocm9uaXplKCkuICcgK1xuICAgICAgICAgICAgJ0FsbCBidXQgdGhlIGxhc3QgYXJndW1lbnQgbXVzdCBiZSBEeWdyYXBoIG9iamVjdHMuJztcbiAgICB9IGVsc2UgaWYgKGkgPT0gYXJndW1lbnRzLmxlbmd0aCAtIDEpIHtcbiAgICAgIHBhcnNlT3B0cyhhcmd1bWVudHNbYXJndW1lbnRzLmxlbmd0aCAtIDFdKTtcbiAgICB9XG4gIH0gZWxzZSBpZiAoYXJndW1lbnRzWzBdLmxlbmd0aCkge1xuICAgIC8vIEludm9rZWQgdy8gbGlzdCBvZiBkeWdyYXBocywgb3B0aW9uc1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXJndW1lbnRzWzBdLmxlbmd0aDsgaSsrKSB7XG4gICAgICBkeWdyYXBocy5wdXNoKGFyZ3VtZW50c1swXVtpXSk7XG4gICAgfVxuICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID09IDIpIHtcbiAgICAgIHBhcnNlT3B0cyhhcmd1bWVudHNbMV0pO1xuICAgIH0gZWxzZSBpZiAoYXJndW1lbnRzLmxlbmd0aCA+IDIpIHtcbiAgICAgIHRocm93ICdJbnZhbGlkIGludm9jYXRpb24gb2YgRHlncmFwaC5zeW5jaHJvbml6ZSgpLiAnICtcbiAgICAgICAgICAgICdFeHBlY3RlZCB0d28gYXJndW1lbnRzOiBhcnJheSBhbmQgb3B0aW9uYWwgb3B0aW9ucyBhcmd1bWVudC4nO1xuICAgIH0gIC8vIG90aGVyd2lzZSBhcmd1bWVudHMubGVuZ3RoID09IDEsIHdoaWNoIGlzIGZpbmUuXG4gIH0gZWxzZSB7XG4gICAgdGhyb3cgJ0ludmFsaWQgaW52b2NhdGlvbiBvZiBEeWdyYXBoLnN5bmNocm9uaXplKCkuICcgK1xuICAgICAgICAgICdGaXJzdCBwYXJhbWV0ZXIgbXVzdCBiZSBlaXRoZXIgRHlncmFwaCBvciBsaXN0IG9mIER5Z3JhcGhzLic7XG4gIH1cblxuICBpZiAoZHlncmFwaHMubGVuZ3RoIDwgMikge1xuICAgIHRocm93ICdJbnZhbGlkIGludm9jYXRpb24gb2YgRHlncmFwaC5zeW5jaHJvbml6ZSgpLiAnICtcbiAgICAgICAgICAnTmVlZCB0d28gb3IgbW9yZSBkeWdyYXBocyB0byBzeW5jaHJvbml6ZS4nO1xuICB9XG5cbiAgdmFyIHJlYWR5Y291bnQgPSBkeWdyYXBocy5sZW5ndGg7XG4gIGZvciAodmFyIGkgPSAwOyBpIDwgZHlncmFwaHMubGVuZ3RoOyBpKyspIHtcbiAgICB2YXIgZyA9IGR5Z3JhcGhzW2ldO1xuICAgIGcucmVhZHkoIGZ1bmN0aW9uKCkge1xuICAgICAgaWYgKC0tcmVhZHljb3VudCA9PSAwKSB7XG4gICAgICAgIC8vIHN0b3JlIG9yaWdpbmFsIGNhbGxiYWNrc1xuICAgICAgICB2YXIgY2FsbEJhY2tUeXBlcyA9IFsnZHJhd0NhbGxiYWNrJywgJ2hpZ2hsaWdodENhbGxiYWNrJywgJ3VuaGlnaGxpZ2h0Q2FsbGJhY2snXTtcbiAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBkeWdyYXBocy5sZW5ndGg7IGorKykge1xuICAgICAgICAgIGlmICghcHJldkNhbGxiYWNrc1tqXSkge1xuICAgICAgICAgICAgcHJldkNhbGxiYWNrc1tqXSA9IHt9O1xuICAgICAgICAgIH1cbiAgICAgICAgICBmb3IgKHZhciBrID0gY2FsbEJhY2tUeXBlcy5sZW5ndGggLSAxOyBrID49IDA7IGstLSkge1xuICAgICAgICAgICAgcHJldkNhbGxiYWNrc1tqXVtjYWxsQmFja1R5cGVzW2tdXSA9IGR5Z3JhcGhzW2pdLmdldEZ1bmN0aW9uT3B0aW9uKGNhbGxCYWNrVHlwZXNba10pO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIExpc3RlbiBmb3IgZHJhdywgaGlnaGxpZ2h0LCB1bmhpZ2hsaWdodCBjYWxsYmFja3MuXG4gICAgICAgIGlmIChvcHRzLnpvb20pIHtcbiAgICAgICAgICBhdHRhY2hab29tSGFuZGxlcnMoZHlncmFwaHMsIG9wdHMsIHByZXZDYWxsYmFja3MpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKG9wdHMuc2VsZWN0aW9uKSB7XG4gICAgICAgICAgYXR0YWNoU2VsZWN0aW9uSGFuZGxlcnMoZHlncmFwaHMsIHByZXZDYWxsYmFja3MpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICByZXR1cm4ge1xuICAgIGRldGFjaDogZnVuY3Rpb24oKSB7XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGR5Z3JhcGhzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHZhciBnID0gZHlncmFwaHNbaV07XG4gICAgICAgIGlmIChvcHRzLnpvb20pIHtcbiAgICAgICAgICBnLnVwZGF0ZU9wdGlvbnMoe2RyYXdDYWxsYmFjazogcHJldkNhbGxiYWNrc1tpXS5kcmF3Q2FsbGJhY2t9KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAob3B0cy5zZWxlY3Rpb24pIHtcbiAgICAgICAgICBnLnVwZGF0ZU9wdGlvbnMoe1xuICAgICAgICAgICAgaGlnaGxpZ2h0Q2FsbGJhY2s6IHByZXZDYWxsYmFja3NbaV0uaGlnaGxpZ2h0Q2FsbGJhY2ssXG4gICAgICAgICAgICB1bmhpZ2hsaWdodENhbGxiYWNrOiBwcmV2Q2FsbGJhY2tzW2ldLnVuaGlnaGxpZ2h0Q2FsbGJhY2tcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgLy8gcmVsZWFzZSByZWZlcmVuY2VzICYgbWFrZSBzdWJzZXF1ZW50IGNhbGxzIHRocm93LlxuICAgICAgZHlncmFwaHMgPSBudWxsO1xuICAgICAgb3B0cyA9IG51bGw7XG4gICAgICBwcmV2Q2FsbGJhY2tzID0gbnVsbDtcbiAgICB9XG4gIH07XG59O1xuXG5mdW5jdGlvbiBhcnJheXNBcmVFcXVhbChhLCBiKSB7XG4gIGlmICghQXJyYXkuaXNBcnJheShhKSB8fCAhQXJyYXkuaXNBcnJheShiKSkgcmV0dXJuIGZhbHNlO1xuICB2YXIgaSA9IGEubGVuZ3RoO1xuICBpZiAoaSAhPT0gYi5sZW5ndGgpIHJldHVybiBmYWxzZTtcbiAgd2hpbGUgKGktLSkge1xuICAgIGlmIChhW2ldICE9PSBiW2ldKSByZXR1cm4gZmFsc2U7XG4gIH1cbiAgcmV0dXJuIHRydWU7XG59XG5cbmZ1bmN0aW9uIGF0dGFjaFpvb21IYW5kbGVycyhncywgc3luY09wdHMsIHByZXZDYWxsYmFja3MpIHtcbiAgdmFyIGJsb2NrID0gZmFsc2U7XG4gIGZvciAodmFyIGkgPSAwOyBpIDwgZ3MubGVuZ3RoOyBpKyspIHtcbiAgICB2YXIgZyA9IGdzW2ldO1xuICAgIGcudXBkYXRlT3B0aW9ucyh7XG4gICAgICBkcmF3Q2FsbGJhY2s6IGZ1bmN0aW9uKG1lLCBpbml0aWFsKSB7XG4gICAgICAgIGlmIChibG9jayB8fCBpbml0aWFsKSB7XG4gICAgICAgICAgLy8gY2FsbCB0aGUgdXNlcuKAmXMgZHJhd0NhbGxiYWNrIGV2ZW4gaWYgd2UgYXJlIGJsb2NrZWRcbiAgICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IGdzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICBpZiAoZ3Nbal0gPT0gbWUpIHtcbiAgICAgICAgICAgICAgaWYgKHByZXZDYWxsYmFja3Nbal0gJiYgcHJldkNhbGxiYWNrc1tqXS5kcmF3Q2FsbGJhY2spIHtcbiAgICAgICAgICAgICAgICBwcmV2Q2FsbGJhY2tzW2pdLmRyYXdDYWxsYmFjay5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBibG9jayA9IHRydWU7XG4gICAgICAgIHZhciBvcHRzID0ge1xuICAgICAgICAgIGRhdGVXaW5kb3c6IG1lLnhBeGlzUmFuZ2UoKVxuICAgICAgICB9O1xuICAgICAgICBpZiAoc3luY09wdHMucmFuZ2UpXG4gICAgICAgICAgb3B0cy52YWx1ZVJhbmdlID0gbWUueUF4aXNSYW5nZSgpO1xuXG4gICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgZ3MubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICBpZiAoZ3Nbal0gPT0gbWUpIHtcbiAgICAgICAgICAgIGlmIChwcmV2Q2FsbGJhY2tzW2pdICYmIHByZXZDYWxsYmFja3Nbal0uZHJhd0NhbGxiYWNrKSB7XG4gICAgICAgICAgICAgIHByZXZDYWxsYmFja3Nbal0uZHJhd0NhbGxiYWNrLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICAvLyBPbmx5IHJlZHJhdyBpZiB0aGVyZSBhcmUgbmV3IG9wdGlvbnNcbiAgICAgICAgICBpZiAoYXJyYXlzQXJlRXF1YWwob3B0cy5kYXRlV2luZG93LCBnc1tqXS5nZXRPcHRpb24oJ2RhdGVXaW5kb3cnKSkgJiZcbiAgICAgICAgICAgICAgKCFzeW5jT3B0cy5yYW5nZSB8fFxuICAgICAgICAgICAgICAgYXJyYXlzQXJlRXF1YWwob3B0cy52YWx1ZVJhbmdlLCBnc1tqXS5nZXRPcHRpb24oJ3ZhbHVlUmFuZ2UnKSkpKSB7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBnc1tqXS51cGRhdGVPcHRpb25zKG9wdHMpO1xuICAgICAgICB9XG4gICAgICAgIGJsb2NrID0gZmFsc2U7XG4gICAgICB9XG4gICAgfSwgdHJ1ZSAvKiBubyBuZWVkIHRvIHJlZHJhdyAqLyk7XG4gIH1cbn1cblxuZnVuY3Rpb24gYXR0YWNoU2VsZWN0aW9uSGFuZGxlcnMoZ3MsIHByZXZDYWxsYmFja3MpIHtcbiAgdmFyIGJsb2NrID0gZmFsc2U7XG4gIGZvciAodmFyIGkgPSAwOyBpIDwgZ3MubGVuZ3RoOyBpKyspIHtcbiAgICB2YXIgZyA9IGdzW2ldO1xuXG4gICAgZy51cGRhdGVPcHRpb25zKHtcbiAgICAgIGhpZ2hsaWdodENhbGxiYWNrOiBmdW5jdGlvbihldmVudCwgeCwgcG9pbnRzLCByb3csIHNlcmllc05hbWUpIHtcbiAgICAgICAgaWYgKGJsb2NrKSByZXR1cm47XG4gICAgICAgIGJsb2NrID0gdHJ1ZTtcbiAgICAgICAgdmFyIG1lID0gdGhpcztcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBncy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgIGlmIChtZSA9PSBnc1tpXSkge1xuICAgICAgICAgICAgaWYgKHByZXZDYWxsYmFja3NbaV0gJiYgcHJldkNhbGxiYWNrc1tpXS5oaWdobGlnaHRDYWxsYmFjaykge1xuICAgICAgICAgICAgICBwcmV2Q2FsbGJhY2tzW2ldLmhpZ2hsaWdodENhbGxiYWNrLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdmFyIGlkeCA9IGdzW2ldLmdldFJvd0ZvclgoeCk7XG4gICAgICAgICAgaWYgKGlkeCAhPT0gbnVsbCkge1xuICAgICAgICAgICAgZ3NbaV0uc2V0U2VsZWN0aW9uKGlkeCwgc2VyaWVzTmFtZSwgdW5kZWZpbmVkLCB0cnVlKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgYmxvY2sgPSBmYWxzZTtcbiAgICAgIH0sXG4gICAgICB1bmhpZ2hsaWdodENhbGxiYWNrOiBmdW5jdGlvbihldmVudCkge1xuICAgICAgICBpZiAoYmxvY2spIHJldHVybjtcbiAgICAgICAgYmxvY2sgPSB0cnVlO1xuICAgICAgICB2YXIgbWUgPSB0aGlzO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGdzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgaWYgKG1lID09IGdzW2ldKSB7XG4gICAgICAgICAgICBpZiAocHJldkNhbGxiYWNrc1tpXSAmJiBwcmV2Q2FsbGJhY2tzW2ldLnVuaGlnaGxpZ2h0Q2FsbGJhY2spIHtcbiAgICAgICAgICAgICAgcHJldkNhbGxiYWNrc1tpXS51bmhpZ2hsaWdodENhbGxiYWNrLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICB9XG4gICAgICAgICAgZ3NbaV0uY2xlYXJTZWxlY3Rpb24oKTtcbiAgICAgICAgfVxuICAgICAgICBibG9jayA9IGZhbHNlO1xuICAgICAgfVxuICAgIH0sIHRydWUgLyogbm8gbmVlZCB0byByZWRyYXcgKi8pO1xuICB9XG59XG5cbkR5Z3JhcGguc3luY2hyb25pemUgPSBzeW5jaHJvbml6ZTtcblxufSkoKTtcbiJdLCJtYXBwaW5ncyI6Ijs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQyxZQUFXO0VBQ1o7RUFDQSxZQUFZOztFQUVaLElBQUlBLE9BQU87RUFDWCxJQUFJQyxNQUFNLENBQUNELE9BQU8sRUFBRTtJQUNsQkEsT0FBTyxHQUFHQyxNQUFNLENBQUNELE9BQU87RUFDMUIsQ0FBQyxNQUFN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