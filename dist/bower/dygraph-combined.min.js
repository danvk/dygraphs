/*! @license Copyright 2014 Dan Vanderkam (danvdk@gmail.com) MIT-licensed (http://opensource.org/licenses/MIT) */Dygraph.Plugins.Annotations=function(){"use strict";var t=function(){this.annotations_=[]};return t.prototype.toString=function(){return"Annotations Plugin"},t.prototype.activate=function(){return{clearChart:this.clearChart,didDrawChart:this.didDrawChart}},t.prototype.detachLabels=function(){for(var t=0;t<this.annotations_.length;t++){var e=this.annotations_[t];e.parentNode&&e.parentNode.removeChild(e),this.annotations_[t]=null}this.annotations_=[]},t.prototype.clearChart=function(){this.detachLabels()},t.prototype.didDrawChart=function(t){var e=t.dygraph,a=e.layout_.annotated_points;if(a&&0!==a.length)for(var n=t.canvas.parentNode,i={position:"absolute",fontSize:e.getOption("axisLabelFontSize")+"px",zIndex:10,overflow:"hidden"},r=function(t,a,n){return function(i){var r=n.annotation;r.hasOwnProperty(t)?r[t](r,n,e,i):e.getOption(a)&&e.getOption(a)(r,n,e,i)}},o=t.dygraph.plotter_.area,l={},s=0;s<a.length;s++){var h=a[s];if(!(h.canvasx<o.x||h.canvasx>o.x+o.w||h.canvasy<o.y||h.canvasy>o.y+o.h)){var p=h.annotation,d=6;p.hasOwnProperty("tickHeight")&&(d=p.tickHeight);var c=document.createElement("div");for(var g in i)i.hasOwnProperty(g)&&(c.style[g]=i[g]);p.hasOwnProperty("icon")||(c.className="dygraphDefaultAnnotation"),p.hasOwnProperty("cssClass")&&(c.className+=" "+p.cssClass);var u=p.hasOwnProperty("width")?p.width:16,y=p.hasOwnProperty("height")?p.height:16;if(p.hasOwnProperty("icon")){var v=document.createElement("img");v.src=p.icon,v.width=u,v.height=y,c.appendChild(v)}else h.annotation.hasOwnProperty("shortText")&&c.appendChild(document.createTextNode(h.annotation.shortText));var _=h.canvasx-u/2;c.style.left=_+"px";var f=0;if(p.attachAtBottom){var x=o.y+o.h-y-d;l[_]?x-=l[_]:l[_]=0,l[_]+=d+y,f=x}else f=h.canvasy-y-d;c.style.top=f+"px",c.style.width=u+"px",c.style.height=y+"px",c.title=h.annotation.text,c.style.color=e.colorsMap_[h.name],c.style.borderColor=e.colorsMap_[h.name],p.div=c,e.addAndTrackEvent(c,"click",r("clickHandler","annotationClickHandler",h,this)),e.addAndTrackEvent(c,"mouseover",r("mouseOverHandler","annotationMouseOverHandler",h,this)),e.addAndTrackEvent(c,"mouseout",r("mouseOutHandler","annotationMouseOutHandler",h,this)),e.addAndTrackEvent(c,"dblclick",r("dblClickHandler","annotationDblClickHandler",h,this)),n.appendChild(c),this.annotations_.push(c);var m=t.drawingContext;if(m.save(),m.strokeStyle=e.colorsMap_[h.name],m.beginPath(),p.attachAtBottom){var x=f+y;m.moveTo(h.canvasx,x),m.lineTo(h.canvasx,x+d)}else m.moveTo(h.canvasx,h.canvasy),m.lineTo(h.canvasx,h.canvasy-2-d);m.closePath(),m.stroke(),m.restore()}}},t.prototype.destroy=function(){this.detachLabels()},t}(),Dygraph.Plugins.Axes=function(){"use strict";var t=function(){this.xlabels_=[],this.ylabels_=[]};return t.prototype.toString=function(){return"Axes Plugin"},t.prototype.activate=function(){return{layout:this.layout,clearChart:this.clearChart,willDrawChart:this.willDrawChart}},t.prototype.layout=function(t){var e=t.dygraph;if(e.getOptionForAxis("drawAxis","y")){var a=e.getOptionForAxis("axisLabelWidth","y")+2*e.getOptionForAxis("axisTickSize","y");t.reserveSpaceLeft(a)}if(e.getOptionForAxis("drawAxis","x")){var n;n=e.getOption("xAxisHeight")?e.getOption("xAxisHeight"):e.getOptionForAxis("axisLabelFontSize","x")+2*e.getOptionForAxis("axisTickSize","x"),t.reserveSpaceBottom(n)}if(2==e.numAxes()){if(e.getOptionForAxis("drawAxis","y2")){var a=e.getOptionForAxis("axisLabelWidth","y2")+2*e.getOptionForAxis("axisTickSize","y2");t.reserveSpaceRight(a)}}else e.numAxes()>2&&e.error("Only two y-axes are supported at this time. (Trying to use "+e.numAxes()+")")},t.prototype.detachLabels=function(){function t(t){for(var e=0;e<t.length;e++){var a=t[e];a.parentNode&&a.parentNode.removeChild(a)}}t(this.xlabels_),t(this.ylabels_),this.xlabels_=[],this.ylabels_=[]},t.prototype.clearChart=function(){this.detachLabels()},t.prototype.willDrawChart=function(t){function e(t){return Math.round(t)+.5}function a(t){return Math.round(t)-.5}var n=t.dygraph;if(n.getOptionForAxis("drawAxis","x")||n.getOptionForAxis("drawAxis","y")||n.getOptionForAxis("drawAxis","y2")){var i,r,o,l,s,h=t.drawingContext,p=t.canvas.parentNode,d=n.width_,c=n.height_,g=function(t){return{position:"absolute",fontSize:n.getOptionForAxis("axisLabelFontSize",t)+"px",zIndex:10,color:n.getOptionForAxis("axisLabelColor",t),width:n.getOptionForAxis("axisLabelWidth",t)+"px",lineHeight:"normal",overflow:"hidden"}},u={x:g("x"),y:g("y"),y2:g("y2")},y=function(t,e,a){var n=document.createElement("div"),i=u["y2"==a?"y2":e];for(var r in i)i.hasOwnProperty(r)&&(n.style[r]=i[r]);var o=document.createElement("div");return o.className="dygraph-axis-label dygraph-axis-label-"+e+(a?" dygraph-axis-label-"+a:""),o.innerHTML=t,n.appendChild(o),n};h.save();var v=n.layout_,_=t.dygraph.plotter_.area,f=function(t){return function(e){return n.getOptionForAxis(e,t)}};if(n.getOptionForAxis("drawAxis","y")){if(v.yticks&&v.yticks.length>0){var x=n.numAxes(),m=[f("y"),f("y2")];for(s=0;s<v.yticks.length;s++){if(l=v.yticks[s],"function"==typeof l)return;r=_.x;var b=1,w="y1",A=m[0];1==l[0]&&(r=_.x+_.w,b=-1,w="y2",A=m[1]);var D=A("axisLabelFontSize");o=_.y+l[1]*_.h,i=y(l[2],"y",2==x?w:null);var H=o-D/2;0>H&&(H=0),H+D+3>c?i.style.bottom="0":i.style.top=H+"px",0===l[0]?(i.style.left=_.x-A("axisLabelWidth")-A("axisTickSize")+"px",i.style.textAlign="right"):1==l[0]&&(i.style.left=_.x+_.w+A("axisTickSize")+"px",i.style.textAlign="left"),i.style.width=A("axisLabelWidth")+"px",p.appendChild(i),this.ylabels_.push(i)}var O=this.ylabels_[0],D=n.getOptionForAxis("axisLabelFontSize","y"),C=parseInt(O.style.top,10)+D;C>c-D&&(O.style.top=parseInt(O.style.top,10)-D/2+"px")}var S;if(n.getOption("drawAxesAtZero")){var T=n.toPercentXCoord(0);(T>1||0>T||isNaN(T))&&(T=0),S=e(_.x+T*_.w)}else S=e(_.x);h.strokeStyle=n.getOptionForAxis("axisLineColor","y"),h.lineWidth=n.getOptionForAxis("axisLineWidth","y"),h.beginPath(),h.moveTo(S,a(_.y)),h.lineTo(S,a(_.y+_.h)),h.closePath(),h.stroke(),2==n.numAxes()&&(h.strokeStyle=n.getOptionForAxis("axisLineColor","y2"),h.lineWidth=n.getOptionForAxis("axisLineWidth","y2"),h.beginPath(),h.moveTo(a(_.x+_.w),a(_.y)),h.lineTo(a(_.x+_.w),a(_.y+_.h)),h.closePath(),h.stroke())}if(n.getOptionForAxis("drawAxis","x")){if(v.xticks){var A=f("x");for(s=0;s<v.xticks.length;s++){l=v.xticks[s],r=_.x+l[0]*_.w,o=_.y+_.h,i=y(l[1],"x"),i.style.textAlign="center",i.style.top=o+A("axisTickSize")+"px";var L=r-A("axisLabelWidth")/2;L+A("axisLabelWidth")>d&&(L=d-A("axisLabelWidth"),i.style.textAlign="right"),0>L&&(L=0,i.style.textAlign="left"),i.style.left=L+"px",i.style.width=A("axisLabelWidth")+"px",p.appendChild(i),this.xlabels_.push(i)}}h.strokeStyle=n.getOptionForAxis("axisLineColor","x"),h.lineWidth=n.getOptionForAxis("axisLineWidth","x"),h.beginPath();var P;if(n.getOption("drawAxesAtZero")){var T=n.toPercentYCoord(0,0);(T>1||0>T)&&(T=1),P=a(_.y+T*_.h)}else P=a(_.y+_.h);h.moveTo(e(_.x),P),h.lineTo(e(_.x+_.w),P),h.closePath(),h.stroke()}h.restore()}},t}(),Dygraph.Plugins.ChartLabels=function(){"use strict";var t=function(){this.title_div_=null,this.xlabel_div_=null,this.ylabel_div_=null,this.y2label_div_=null};t.prototype.toString=function(){return"ChartLabels Plugin"},t.prototype.activate=function(){return{layout:this.layout,didDrawChart:this.didDrawChart}};var e=function(t){var e=document.createElement("div");return e.style.position="absolute",e.style.left=t.x+"px",e.style.top=t.y+"px",e.style.width=t.w+"px",e.style.height=t.h+"px",e};t.prototype.detachLabels_=function(){for(var t=[this.title_div_,this.xlabel_div_,this.ylabel_div_,this.y2label_div_],e=0;e<t.length;e++){var a=t[e];a&&a.parentNode&&a.parentNode.removeChild(a)}this.title_div_=null,this.xlabel_div_=null,this.ylabel_div_=null,this.y2label_div_=null};var a=function(t,e,a,n,i){var r=document.createElement("div");r.style.position="absolute",r.style.left=1==a?"0px":e.x+"px",r.style.top=e.y+"px",r.style.width=e.w+"px",r.style.height=e.h+"px",r.style.fontSize=t.getOption("yLabelWidth")-2+"px";var o=document.createElement("div");o.style.position="absolute",o.style.width=e.h+"px",o.style.height=e.w+"px",o.style.top=e.h/2-e.w/2+"px",o.style.left=e.w/2-e.h/2+"px",o.style.textAlign="center";var l="rotate("+(1==a?"-":"")+"90deg)";o.style.transform=l,o.style.WebkitTransform=l,o.style.MozTransform=l,o.style.OTransform=l,o.style.msTransform=l;var s=document.createElement("div");return s.className=n,s.innerHTML=i,o.appendChild(s),r.appendChild(o),r};return t.prototype.layout=function(t){this.detachLabels_();var n=t.dygraph,i=t.chart_div;if(n.getOption("title")){var r=t.reserveSpaceTop(n.getOption("titleHeight"));this.title_div_=e(r),this.title_div_.style.textAlign="center",this.title_div_.style.fontSize=n.getOption("titleHeight")-8+"px",this.title_div_.style.fontWeight="bold",this.title_div_.style.zIndex=10;var o=document.createElement("div");o.className="dygraph-label dygraph-title",o.innerHTML=n.getOption("title"),this.title_div_.appendChild(o),i.appendChild(this.title_div_)}if(n.getOption("xlabel")){var l=t.reserveSpaceBottom(n.getOption("xLabelHeight"));this.xlabel_div_=e(l),this.xlabel_div_.style.textAlign="center",this.xlabel_div_.style.fontSize=n.getOption("xLabelHeight")-2+"px";var o=document.createElement("div");o.className="dygraph-label dygraph-xlabel",o.innerHTML=n.getOption("xlabel"),this.xlabel_div_.appendChild(o),i.appendChild(this.xlabel_div_)}if(n.getOption("ylabel")){var s=t.reserveSpaceLeft(0);this.ylabel_div_=a(n,s,1,"dygraph-label dygraph-ylabel",n.getOption("ylabel")),i.appendChild(this.ylabel_div_)}if(n.getOption("y2label")&&2==n.numAxes()){var h=t.reserveSpaceRight(0);this.y2label_div_=a(n,h,2,"dygraph-label dygraph-y2label",n.getOption("y2label")),i.appendChild(this.y2label_div_)}},t.prototype.didDrawChart=function(t){var e=t.dygraph;this.title_div_&&(this.title_div_.children[0].innerHTML=e.getOption("title")),this.xlabel_div_&&(this.xlabel_div_.children[0].innerHTML=e.getOption("xlabel")),this.ylabel_div_&&(this.ylabel_div_.children[0].children[0].innerHTML=e.getOption("ylabel")),this.y2label_div_&&(this.y2label_div_.children[0].children[0].innerHTML=e.getOption("y2label"))},t.prototype.clearChart=function(){},t.prototype.destroy=function(){this.detachLabels_()},t}(),Dygraph.Plugins.Grid=function(){"use strict";var t=function(){};return t.prototype.toString=function(){return"Gridline Plugin"},t.prototype.activate=function(){return{willDrawChart:this.willDrawChart}},t.prototype.willDrawChart=function(t){function e(t){return Math.round(t)+.5}function a(t){return Math.round(t)-.5}var n,i,r,o,l=t.dygraph,s=t.drawingContext,h=l.layout_,p=t.dygraph.plotter_.area;if(l.getOptionForAxis("drawGrid","y")){for(var d=["y","y2"],c=[],g=[],u=[],y=[],v=[],r=0;r<d.length;r++)u[r]=l.getOptionForAxis("drawGrid",d[r]),u[r]&&(c[r]=l.getOptionForAxis("gridLineColor",d[r]),g[r]=l.getOptionForAxis("gridLineWidth",d[r]),v[r]=l.getOptionForAxis("gridLinePattern",d[r]),y[r]=v[r]&&v[r].length>=2);for(o=h.yticks,s.save(),r=0;r<o.length;r++){var _=o[r][0];u[_]&&(y[_]&&s.installPattern(v[_]),s.strokeStyle=c[_],s.lineWidth=g[_],n=e(p.x),i=a(p.y+o[r][1]*p.h),s.beginPath(),s.moveTo(n,i),s.lineTo(n+p.w,i),s.closePath(),s.stroke(),y[_]&&s.uninstallPattern())}s.restore()}if(l.getOptionForAxis("drawGrid","x")){o=h.xticks,s.save();var v=l.getOptionForAxis("gridLinePattern","x"),y=v&&v.length>=2;for(y&&s.installPattern(v),s.strokeStyle=l.getOptionForAxis("gridLineColor","x"),s.lineWidth=l.getOptionForAxis("gridLineWidth","x"),r=0;r<o.length;r++)n=e(p.x+o[r][0]*p.w),i=a(p.y+p.h),s.beginPath(),s.moveTo(n,i),s.lineTo(n,p.y),s.closePath(),s.stroke();y&&s.uninstallPattern(),s.restore()}},t.prototype.destroy=function(){},t}(),Dygraph.Plugins.Legend=function(){"use strict";var t=function(){this.legend_div_=null,this.is_generated_div_=!1};t.prototype.toString=function(){return"Legend Plugin"};var e;t.prototype.activate=function(t){var e,a=t.getOption("labelsDivWidth"),n=t.getOption("labelsDiv");if(n&&null!==n)e="string"==typeof n||n instanceof String?document.getElementById(n):n;else{var i={position:"absolute",fontSize:"14px",zIndex:10,width:a+"px",top:"0px",left:t.size().width-a-2+"px",background:"white",lineHeight:"normal",textAlign:"left",overflow:"hidden"};Dygraph.update(i,t.getOption("labelsDivStyles")),e=document.createElement("div"),e.className="dygraph-legend";for(var r in i)if(i.hasOwnProperty(r))try{e.style[r]=i[r]}catch(o){console.warn("You are using unsupported css properties for your browser in labelsDivStyles")}t.graphDiv.appendChild(e),this.is_generated_div_=!0}return this.legend_div_=e,this.one_em_width_=10,{select:this.select,deselect:this.deselect,predraw:this.predraw,didDrawChart:this.didDrawChart}};var a=function(t){var e=document.createElement("span");e.setAttribute("style","margin: 0; padding: 0 0 0 1em; border: 0;"),t.appendChild(e);var a=e.offsetWidth;return t.removeChild(e),a},n=function(t){return t.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")};return t.prototype.select=function(e){var a=e.selectedX,n=e.selectedPoints,i=e.selectedRow,r=e.dygraph.getOption("legend");if("never"===r)return void(this.legend_div_.style.display="none");if("follow"===r){var o=e.dygraph.plotter_.area,l=e.dygraph.getOption("labelsDivWidth"),s=e.dygraph.getOptionForAxis("axisLabelWidth","y"),h=n[0].x*o.w+20,p=n[0].y*o.h-20;h+l+1>window.scrollX+window.innerWidth&&(h=h-40-l-(s-o.x)),e.dygraph.graphDiv.appendChild(this.legend_div_),this.legend_div_.style.left=s+h+"px",this.legend_div_.style.top=p+"px"}var d=t.generateLegendHTML(e.dygraph,a,n,this.one_em_width_,i);this.legend_div_.innerHTML=d,this.legend_div_.style.display=""},t.prototype.deselect=function(e){var n=e.dygraph.getOption("legend");"always"!==n&&(this.legend_div_.style.display="none");var i=a(this.legend_div_);this.one_em_width_=i;var r=t.generateLegendHTML(e.dygraph,void 0,void 0,i,null);this.legend_div_.innerHTML=r},t.prototype.didDrawChart=function(t){this.deselect(t)},t.prototype.predraw=function(t){if(this.is_generated_div_){t.dygraph.graphDiv.appendChild(this.legend_div_);var e=t.dygraph.plotter_.area,a=t.dygraph.getOption("labelsDivWidth");this.legend_div_.style.left=e.x+e.w-a-1+"px",this.legend_div_.style.top=e.y+"px",this.legend_div_.style.width=a+"px"}},t.prototype.destroy=function(){this.legend_div_=null},t.generateLegendHTML=function(t,a,i,r,o){if(t.getOption("showLabelsOnHighlight")!==!0)return"";var l,s,h,p,d,c=t.getLabels();if("undefined"==typeof a){if("always"!=t.getOption("legend"))return"";for(s=t.getOption("labelsSeparateLines"),l="",h=1;h<c.length;h++){var g=t.getPropertiesForSeries(c[h]);g.visible&&(""!==l&&(l+=s?"<br/>":" "),d=t.getOption("strokePattern",c[h]),p=e(d,g.color,r),l+="<span style='font-weight: bold; color: "+g.color+";'>"+p+" "+n(c[h])+"</span>")}return l}var u=t.optionsViewForAxis_("x"),y=u("valueFormatter");l=y.call(t,a,u,c[0],t,o,0),""!==l&&(l+=":");var v=[],_=t.numAxes();for(h=0;_>h;h++)v[h]=t.optionsViewForAxis_("y"+(h?1+h:""));var f=t.getOption("labelsShowZeroValues");s=t.getOption("labelsSeparateLines");var x=t.getHighlightSeries();for(h=0;h<i.length;h++){var m=i[h];if((0!==m.yval||f)&&Dygraph.isOK(m.canvasy)){s&&(l+="<br/>");var g=t.getPropertiesForSeries(m.name),b=v[g.axis-1],w=b("valueFormatter"),A=w.call(t,m.yval,b,m.name,t,o,c.indexOf(m.name)),D=m.name==x?" class='highlight'":"";l+="<span"+D+"> <b><span style='color: "+g.color+";'>"+n(m.name)+"</span></b>:&#160;"+A+"</span>"}}return l},e=function(t,e,a){if(!t||t.length<=1)return'<div style="display: inline-block; position: relative; bottom: .5ex; padding-left: 1em; height: 1px; border-bottom: 2px solid '+e+';"></div>';var n,i,r,o,l,s=0,h=0,p=[];for(n=0;n<=t.length;n++)s+=t[n%t.length];if(l=Math.floor(a/(s-t[0])),l>1){for(n=0;n<t.length;n++)p[n]=t[n]/a;h=p.length}else{for(l=1,n=0;n<t.length;n++)p[n]=t[n]/s;h=p.length+1}var d="";for(i=0;l>i;i++)for(n=0;h>n;n+=2)r=p[n%p.length],o=n<t.length?p[(n+1)%p.length]:0,d+='<div style="display: inline-block; position: relative; bottom: .5ex; margin-right: '+o+"em; padding-left: "+r+"em; height: 1px; border-bottom: 2px solid "+e+';"></div>';return d},t}(),Dygraph.Plugins.RangeSelector=function(){"use strict";var t=function(){this.isIE_=/MSIE/.test(navigator.userAgent)&&!window.opera,this.hasTouchInterface_="undefined"!=typeof TouchEvent,this.isMobileDevice_=/mobile|android/gi.test(navigator.appVersion),this.interfaceCreated_=!1};return t.prototype.toString=function(){return"RangeSelector Plugin"},t.prototype.activate=function(t){return this.dygraph_=t,this.getOption_("showRangeSelector")&&this.createInterface_(),{layout:this.reserveSpace_,predraw:this.renderStaticLayer_,didDrawChart:this.renderInteractiveLayer_}},t.prototype.destroy=function(){this.bgcanvas_=null,this.fgcanvas_=null,this.leftZoomHandle_=null,this.rightZoomHandle_=null},t.prototype.getOption_=function(t,e){return this.dygraph_.getOption(t,e)},t.prototype.setDefaultOption_=function(t,e){this.dygraph_.attrs_[t]=e},t.prototype.createInterface_=function(){this.createCanvases_(),this.createZoomHandles_(),this.initInteraction_(),this.getOption_("animatedZooms")&&(console.warn("Animated zooms and range selector are not compatible; disabling animatedZooms."),this.dygraph_.updateOptions({animatedZooms:!1},!0)),this.interfaceCreated_=!0,this.addToGraph_()},t.prototype.addToGraph_=function(){var t=this.graphDiv_=this.dygraph_.graphDiv;t.appendChild(this.bgcanvas_),t.appendChild(this.fgcanvas_),t.appendChild(this.leftZoomHandle_),t.appendChild(this.rightZoomHandle_)},t.prototype.removeFromGraph_=function(){var t=this.graphDiv_;t.removeChild(this.bgcanvas_),t.removeChild(this.fgcanvas_),t.removeChild(this.leftZoomHandle_),t.removeChild(this.rightZoomHandle_),this.graphDiv_=null},t.prototype.reserveSpace_=function(t){this.getOption_("showRangeSelector")&&t.reserveSpaceBottom(this.getOption_("rangeSelectorHeight")+4)},t.prototype.renderStaticLayer_=function(){this.updateVisibility_()&&(this.resize_(),this.drawStaticLayer_())},t.prototype.renderInteractiveLayer_=function(){this.updateVisibility_()&&!this.isChangingRange_&&(this.placeZoomHandles_(),this.drawInteractiveLayer_())},t.prototype.updateVisibility_=function(){var t=this.getOption_("showRangeSelector");if(t)this.interfaceCreated_?this.graphDiv_&&this.graphDiv_.parentNode||this.addToGraph_():this.createInterface_();else if(this.graphDiv_){this.removeFromGraph_();var e=this.dygraph_;setTimeout(function(){e.width_=0,e.resize()},1)}return t},t.prototype.resize_=function(){function t(t,e,a){var n=Dygraph.getContextPixelRatio(e);t.style.top=a.y+"px",t.style.left=a.x+"px",t.width=a.w*n,t.height=a.h*n,t.style.width=a.w+"px",t.style.height=a.h+"px",1!=n&&e.scale(n,n)}var e=this.dygraph_.layout_.getPlotArea(),a=0;this.dygraph_.getOptionForAxis("drawAxis","x")&&(a=this.getOption_("xAxisHeight")||this.getOption_("axisLabelFontSize")+2*this.getOption_("axisTickSize")),this.canvasRect_={x:e.x,y:e.y+e.h+a+4,w:e.w,h:this.getOption_("rangeSelectorHeight")},t(this.bgcanvas_,this.bgcanvas_ctx_,this.canvasRect_),t(this.fgcanvas_,this.fgcanvas_ctx_,this.canvasRect_)},t.prototype.createCanvases_=function(){this.bgcanvas_=Dygraph.createCanvas(),this.bgcanvas_.className="dygraph-rangesel-bgcanvas",this.bgcanvas_.style.position="absolute",this.bgcanvas_.style.zIndex=9,this.bgcanvas_ctx_=Dygraph.getContext(this.bgcanvas_),this.fgcanvas_=Dygraph.createCanvas(),this.fgcanvas_.className="dygraph-rangesel-fgcanvas",this.fgcanvas_.style.position="absolute",this.fgcanvas_.style.zIndex=9,this.fgcanvas_.style.cursor="default",this.fgcanvas_ctx_=Dygraph.getContext(this.fgcanvas_)},t.prototype.createZoomHandles_=function(){var t=new Image;t.className="dygraph-rangesel-zoomhandle",t.style.position="absolute",t.style.zIndex=10,t.style.visibility="hidden",t.style.cursor="col-resize",/MSIE 7/.test(navigator.userAgent)?(t.width=7,t.height=14,t.style.backgroundColor="white",t.style.border="1px solid #333333"):(t.width=9,t.height=16,t.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAkAAAAQCAYAAADESFVDAAAAAXNSR0IArs4c6QAAAAZiS0dEANAAzwDP4Z7KegAAAAlwSFlzAAAOxAAADsQBlSsOGwAAAAd0SU1FB9sHGw0cMqdt1UwAAAAZdEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIEdJTVBXgQ4XAAAAaElEQVQoz+3SsRFAQBCF4Z9WJM8KCDVwownl6YXsTmCUsyKGkZzcl7zkz3YLkypgAnreFmDEpHkIwVOMfpdi9CEEN2nGpFdwD03yEqDtOgCaun7sqSTDH32I1pQA2Pb9sZecAxc5r3IAb21d6878xsAAAAAASUVORK5CYII="),this.isMobileDevice_&&(t.width*=2,t.height*=2),this.leftZoomHandle_=t,this.rightZoomHandle_=t.cloneNode(!1)},t.prototype.initInteraction_=function(){var t,e,a,n,i,r,o,l,s,h,p,d,c,g,u=this,y=document,v=0,_=null,f=!1,x=!1,m=!this.isMobileDevice_,b=new Dygraph.IFrameTarp;t=function(t){var e=u.dygraph_.xAxisExtremes(),a=(e[1]-e[0])/u.canvasRect_.w,n=e[0]+(t.leftHandlePos-u.canvasRect_.x)*a,i=e[0]+(t.rightHandlePos-u.canvasRect_.x)*a;return[n,i]},e=function(t){return Dygraph.cancelEvent(t),f=!0,v=t.clientX,_=t.target?t.target:t.srcElement,("mousedown"===t.type||"dragstart"===t.type)&&(Dygraph.addEvent(y,"mousemove",a),Dygraph.addEvent(y,"mouseup",n)),u.fgcanvas_.style.cursor="col-resize",b.cover(),!0},a=function(t){if(!f)return!1;Dygraph.cancelEvent(t);var e=t.clientX-v;if(Math.abs(e)<4)return!0;v=t.clientX;var a,n=u.getZoomHandleStatus_();_==u.leftZoomHandle_?(a=n.leftHandlePos+e,a=Math.min(a,n.rightHandlePos-_.width-3),a=Math.max(a,u.canvasRect_.x)):(a=n.rightHandlePos+e,a=Math.min(a,u.canvasRect_.x+u.canvasRect_.w),a=Math.max(a,n.leftHandlePos+_.width+3));var r=_.width/2;return _.style.left=a-r+"px",u.drawInteractiveLayer_(),m&&i(),!0},n=function(){return f?(f=!1,b.uncover(),Dygraph.removeEvent(y,"mousemove",a),Dygraph.removeEvent(y,"mouseup",n),u.fgcanvas_.style.cursor="default",m||i(),!0):!1},i=function(){try{var e=u.getZoomHandleStatus_();if(u.isChangingRange_=!0,e.isZoomed){var a=t(e);u.dygraph_.doZoomXDates_(a[0],a[1])}else u.dygraph_.resetZoom()}finally{u.isChangingRange_=!1}},r=function(t){var e=u.leftZoomHandle_.getBoundingClientRect(),a=e.left+e.width/2;e=u.rightZoomHandle_.getBoundingClientRect();var n=e.left+e.width/2;return t.clientX>a&&t.clientX<n},o=function(t){return!x&&r(t)&&u.getZoomHandleStatus_().isZoomed?(Dygraph.cancelEvent(t),x=!0,v=t.clientX,"mousedown"===t.type&&(Dygraph.addEvent(y,"mousemove",l),Dygraph.addEvent(y,"mouseup",s)),!0):!1},l=function(t){if(!x)return!1;Dygraph.cancelEvent(t);var e=t.clientX-v;if(Math.abs(e)<4)return!0;v=t.clientX;var a=u.getZoomHandleStatus_(),n=a.leftHandlePos,i=a.rightHandlePos,r=i-n;n+e<=u.canvasRect_.x?(n=u.canvasRect_.x,i=n+r):i+e>=u.canvasRect_.x+u.canvasRect_.w?(i=u.canvasRect_.x+u.canvasRect_.w,n=i-r):(n+=e,i+=e);var o=u.leftZoomHandle_.width/2;return u.leftZoomHandle_.style.left=n-o+"px",u.rightZoomHandle_.style.left=i-o+"px",u.drawInteractiveLayer_(),m&&h(),!0},s=function(){return x?(x=!1,Dygraph.removeEvent(y,"mousemove",l),Dygraph.removeEvent(y,"mouseup",s),m||h(),!0):!1},h=function(){try{u.isChangingRange_=!0,u.dygraph_.dateWindow_=t(u.getZoomHandleStatus_()),u.dygraph_.drawGraph_(!1)}finally{u.isChangingRange_=!1}},p=function(t){if(!f&&!x){var e=r(t)?"move":"default";e!=u.fgcanvas_.style.cursor&&(u.fgcanvas_.style.cursor=e)}},d=function(t){"touchstart"==t.type&&1==t.targetTouches.length?e(t.targetTouches[0])&&Dygraph.cancelEvent(t):"touchmove"==t.type&&1==t.targetTouches.length?a(t.targetTouches[0])&&Dygraph.cancelEvent(t):n(t)},c=function(t){"touchstart"==t.type&&1==t.targetTouches.length?o(t.targetTouches[0])&&Dygraph.cancelEvent(t):"touchmove"==t.type&&1==t.targetTouches.length?l(t.targetTouches[0])&&Dygraph.cancelEvent(t):s(t)},g=function(t,e){for(var a=["touchstart","touchend","touchmove","touchcancel"],n=0;n<a.length;n++)u.dygraph_.addAndTrackEvent(t,a[n],e)},this.setDefaultOption_("interactionModel",Dygraph.Interaction.dragIsPanInteractionModel),this.setDefaultOption_("panEdgeFraction",1e-4);var w=window.opera?"mousedown":"dragstart";this.dygraph_.addAndTrackEvent(this.leftZoomHandle_,w,e),this.dygraph_.addAndTrackEvent(this.rightZoomHandle_,w,e),this.dygraph_.addAndTrackEvent(this.fgcanvas_,"mousedown",o),this.dygraph_.addAndTrackEvent(this.fgcanvas_,"mousemove",p),this.hasTouchInterface_&&(g(this.leftZoomHandle_,d),g(this.rightZoomHandle_,d),g(this.fgcanvas_,c))},t.prototype.drawStaticLayer_=function(){var t=this.bgcanvas_ctx_;t.clearRect(0,0,this.canvasRect_.w,this.canvasRect_.h);try{this.drawMiniPlot_()}catch(e){console.warn(e)}var a=.5;this.bgcanvas_ctx_.lineWidth=1,t.strokeStyle="gray",t.beginPath(),t.moveTo(a,a),t.lineTo(a,this.canvasRect_.h-a),t.lineTo(this.canvasRect_.w-a,this.canvasRect_.h-a),t.lineTo(this.canvasRect_.w-a,a),t.stroke()},t.prototype.drawMiniPlot_=function(){var t=this.getOption_("rangeSelectorPlotFillColor"),e=this.getOption_("rangeSelectorPlotStrokeColor");if(t||e){var a=this.getOption_("stepPlot"),n=this.computeCombinedSeriesAndLimits_(),i=n.yMax-n.yMin,r=this.bgcanvas_ctx_,o=.5,l=this.dygraph_.xAxisExtremes(),s=Math.max(l[1]-l[0],1e-30),h=(this.canvasRect_.w-o)/s,p=(this.canvasRect_.h-o)/i,d=this.canvasRect_.w-o,c=this.canvasRect_.h-o,g=null,u=null;r.beginPath(),r.moveTo(o,c);for(var y=0;y<n.data.length;y++){var v=n.data[y],_=null!==v[0]?(v[0]-l[0])*h:0/0,f=null!==v[1]?c-(v[1]-n.yMin)*p:0/0;(a||null===g||Math.round(_)!=Math.round(g))&&(isFinite(_)&&isFinite(f)?(null===g?r.lineTo(_,c):a&&r.lineTo(_,u),r.lineTo(_,f),g=_,u=f):(null!==g&&(a?(r.lineTo(_,u),r.lineTo(_,c)):r.lineTo(g,c)),g=u=null))}if(r.lineTo(d,c),r.closePath(),t){var x=this.bgcanvas_ctx_.createLinearGradient(0,0,0,c);x.addColorStop(0,"white"),x.addColorStop(1,t),this.bgcanvas_ctx_.fillStyle=x,r.fill()}e&&(this.bgcanvas_ctx_.strokeStyle=e,this.bgcanvas_ctx_.lineWidth=1.5,r.stroke())}},t.prototype.computeCombinedSeriesAndLimits_=function(){var t,e=this.dygraph_,a=this.getOption_("logscale"),n=e.numColumns(),i=e.getLabels(),r=new Array(n),o=!1;for(t=1;n>t;t++){var l=this.getOption_("showInRangeSelector",i[t]);r[t]=l,null!==l&&(o=!0)}if(!o)for(t=0;t<r.length;t++)r[t]=!0;var s=[],h=e.dataHandler_,p=e.attributes_;for(t=1;t<e.numColumns();t++)if(r[t]){var d=h.extractSeries(e.rawData_,t,p);e.rollPeriod()>1&&(d=h.rollingAverage(d,e.rollPeriod(),p)),s.push(d)}var c=[];for(t=0;t<s[0].length;t++){for(var g=0,u=0,y=0;y<s.length;y++){var v=s[y][t][1];null===v||isNaN(v)||(u++,g+=v)}c.push([s[0][t][0],g/u])}var _=Number.MAX_VALUE,f=-Number.MAX_VALUE;for(t=0;t<c.length;t++){var x=c[t][1];null!==x&&isFinite(x)&&(!a||x>0)&&(_=Math.min(_,x),f=Math.max(f,x))}var m=.25;if(a)for(f=Dygraph.log10(f),f+=f*m,_=Dygraph.log10(_),t=0;t<c.length;t++)c[t][1]=Dygraph.log10(c[t][1]);else{var b,w=f-_;b=w<=Number.MIN_VALUE?f*m:w*m,f+=b,_-=b}return{data:c,yMin:_,yMax:f}},t.prototype.placeZoomHandles_=function(){var t=this.dygraph_.xAxisExtremes(),e=this.dygraph_.xAxisRange(),a=t[1]-t[0],n=Math.max(0,(e[0]-t[0])/a),i=Math.max(0,(t[1]-e[1])/a),r=this.canvasRect_.x+this.canvasRect_.w*n,o=this.canvasRect_.x+this.canvasRect_.w*(1-i),l=Math.max(this.canvasRect_.y,this.canvasRect_.y+(this.canvasRect_.h-this.leftZoomHandle_.height)/2),s=this.leftZoomHandle_.width/2;this.leftZoomHandle_.style.left=r-s+"px",this.leftZoomHandle_.style.top=l+"px",this.rightZoomHandle_.style.left=o-s+"px",this.rightZoomHandle_.style.top=this.leftZoomHandle_.style.top,this.leftZoomHandle_.style.visibility="visible",this.rightZoomHandle_.style.visibility="visible"},t.prototype.drawInteractiveLayer_=function(){var t=this.fgcanvas_ctx_;t.clearRect(0,0,this.canvasRect_.w,this.canvasRect_.h);var e=1,a=this.canvasRect_.w-e,n=this.canvasRect_.h-e,i=this.getZoomHandleStatus_();if(t.strokeStyle="black",i.isZoomed){var r=Math.max(e,i.leftHandlePos-this.canvasRect_.x),o=Math.min(a,i.rightHandlePos-this.canvasRect_.x);t.fillStyle="rgba(240, 240, 240, 0.6)",t.fillRect(0,0,r,this.canvasRect_.h),t.fillRect(o,0,this.canvasRect_.w-o,this.canvasRect_.h),t.beginPath(),t.moveTo(e,e),t.lineTo(r,e),t.lineTo(r,n),t.lineTo(o,n),t.lineTo(o,e),t.lineTo(a,e),t.stroke()}else t.beginPath(),t.moveTo(e,e),t.lineTo(e,n),t.lineTo(a,n),t.lineTo(a,e),t.stroke()},t.prototype.getZoomHandleStatus_=function(){var t=this.leftZoomHandle_.width/2,e=parseFloat(this.leftZoomHandle_.style.left)+t,a=parseFloat(this.rightZoomHandle_.style.left)+t;return{leftHandlePos:e,rightHandlePos:a,isZoomed:e-1>this.canvasRect_.x||a+1<this.canvasRect_.x+this.canvasRect_.w}},t}(),Dygraph.PLUGINS.push(Dygraph.Plugins.Legend,Dygraph.Plugins.Axes,Dygraph.Plugins.RangeSelector,Dygraph.Plugins.ChartLabels,Dygraph.Plugins.Annotations,Dygraph.Plugins.Grid),Dygraph.DataHandler=function(){},Dygraph.DataHandlers={},function(){"use strict";var t=Dygraph.DataHandler;t.X=0,t.Y=1,t.EXTRAS=2,t.prototype.extractSeries=function(){},t.prototype.seriesToPoints=function(e,a,n){for(var i=[],r=0;r<e.length;++r){var o=e[r],l=o[1],s=null===l?null:t.parseFloat(l),h={x:0/0,y:0/0,xval:t.parseFloat(o[0]),yval:s,name:a,idx:r+n};i.push(h)}return this.onPointsCreated_(e,i),i},t.prototype.onPointsCreated_=function(){},t.prototype.rollingAverage=function(){},t.prototype.getExtremeYValues=function(){},t.prototype.onLineEvaluated=function(){},t.prototype.computeYInterpolation_=function(t,e,a){var n=e[1]-t[1],i=e[0]-t[0],r=n/i,o=(a-t[0])*r;return t[1]+o},t.prototype.getIndexesInWindow_=function(t,e){var a=0,n=t.length-1;if(e){for(var i=0,r=e[0],o=e[1];i<t.length-1&&t[i][0]<r;)a++,i++;for(i=t.length-1;i>0&&t[i][0]>o;)n--,i--}return n>=a?[a,n]:[0,t.length-1]},t.parseFloat=function(t){return null===t?0/0:t}}(),function(){"use strict";Dygraph.DataHandlers.DefaultHandler=function(){};var t=Dygraph.DataHandlers.DefaultHandler;t.prototype=new Dygraph.DataHandler,t.prototype.extractSeries=function(t,e,a){for(var n=[],i=a.get("logscale"),r=0;r<t.length;r++){var o=t[r][0],l=t[r][e];i&&0>=l&&(l=null),n.push([o,l])}return n},t.prototype.rollingAverage=function(t,e){e=Math.min(e,t.length);var a,n,i,r,o,l=[];if(1==e)return t;for(a=0;a<t.length;a++){for(r=0,o=0,n=Math.max(0,a-e+1);a+1>n;n++)i=t[n][1],null===i||isNaN(i)||(o++,r+=t[n][1]);l[a]=o?[t[a][0],r/o]:[t[a][0],null]}return l},t.prototype.getExtremeYValues=function(t){for(var e,a=null,n=null,i=0,r=t.length-1,o=i;r>=o;o++)e=t[o][1],null===e||isNaN(e)||((null===n||e>n)&&(n=e),(null===a||a>e)&&(a=e));return[a,n]}}(),function(){"use strict";Dygraph.DataHandlers.DefaultFractionHandler=function(){};var t=Dygraph.DataHandlers.DefaultFractionHandler;t.prototype=new Dygraph.DataHandlers.DefaultHandler,t.prototype.extractSeries=function(t,e,a){for(var n,i,r,o,l,s,h=[],p=100,d=a.get("logscale"),c=0;c<t.length;c++)n=t[c][0],r=t[c][e],d&&null!==r&&(r[0]<=0||r[1]<=0)&&(r=null),null!==r?(o=r[0],l=r[1],null===o||isNaN(o)?h.push([n,o,[o,l]]):(s=l?o/l:0,i=p*s,h.push([n,i,[o,l]]))):h.push([n,null,[null,null]]);return h},t.prototype.rollingAverage=function(t,e){e=Math.min(e,t.length);var a,n=[],i=0,r=0,o=100;for(a=0;a<t.length;a++){i+=t[a][2][0],r+=t[a][2][1],a-e>=0&&(i-=t[a-e][2][0],r-=t[a-e][2][1]);var l=t[a][0],s=r?i/r:0;n[a]=[l,o*s]}return n}}(),function(){"use strict";Dygraph.DataHandlers.BarsHandler=function(){Dygraph.DataHandler.call(this)},Dygraph.DataHandlers.BarsHandler.prototype=new Dygraph.DataHandler;var t=Dygraph.DataHandlers.BarsHandler;t.prototype.extractSeries=function(){},t.prototype.rollingAverage=function(){},t.prototype.onPointsCreated_=function(t,e){for(var a=0;a<t.length;++a){var n=t[a],i=e[a];i.y_top=0/0,i.y_bottom=0/0,i.yval_minus=Dygraph.DataHandler.parseFloat(n[2][0]),i.yval_plus=Dygraph.DataHandler.parseFloat(n[2][1])}},t.prototype.getExtremeYValues=function(t){for(var e,a=null,n=null,i=0,r=t.length-1,o=i;r>=o;o++)if(e=t[o][1],null!==e&&!isNaN(e)){var l=t[o][2][0],s=t[o][2][1];l>e&&(l=e),e>s&&(s=e),(null===n||s>n)&&(n=s),(null===a||a>l)&&(a=l)}return[a,n]},t.prototype.onLineEvaluated=function(t,e,a){for(var n,i=0;i<t.length;i++)n=t[i],n.y_top=DygraphLayout.calcYNormal_(e,n.yval_minus,a),n.y_bottom=DygraphLayout.calcYNormal_(e,n.yval_plus,a)}}(),function(){"use strict";Dygraph.DataHandlers.ErrorBarsHandler=function(){};var t=Dygraph.DataHandlers.ErrorBarsHandler;t.prototype=new Dygraph.DataHandlers.BarsHandler,t.prototype.extractSeries=function(t,e,a){for(var n,i,r,o,l=[],s=a.get("sigma"),h=a.get("logscale"),p=0;p<t.length;p++)n=t[p][0],o=t[p][e],h&&null!==o&&(o[0]<=0||o[0]-s*o[1]<=0)&&(o=null),null!==o?(i=o[0],null===i||isNaN(i)?l.push([n,i,[i,i,i]]):(r=s*o[1],l.push([n,i,[i-r,i+r,o[1]]]))):l.push([n,null,[null,null,null]]);
return l},t.prototype.rollingAverage=function(t,e,a){e=Math.min(e,t.length);var n,i,r,o,l,s,h,p,d,c=[],g=a.get("sigma");for(n=0;n<t.length;n++){for(l=0,p=0,s=0,i=Math.max(0,n-e+1);n+1>i;i++)r=t[i][1],null===r||isNaN(r)||(s++,l+=r,p+=Math.pow(t[i][2][2],2));s?(h=Math.sqrt(p)/s,d=l/s,c[n]=[t[n][0],d,[d-g*h,d+g*h]]):(o=1==e?t[n][1]:null,c[n]=[t[n][0],o,[o,o]])}return c}}(),function(){"use strict";Dygraph.DataHandlers.CustomBarsHandler=function(){};var t=Dygraph.DataHandlers.CustomBarsHandler;t.prototype=new Dygraph.DataHandlers.BarsHandler,t.prototype.extractSeries=function(t,e,a){for(var n,i,r,o=[],l=a.get("logscale"),s=0;s<t.length;s++)n=t[s][0],r=t[s][e],l&&null!==r&&(r[0]<=0||r[1]<=0||r[2]<=0)&&(r=null),null!==r?(i=r[1],o.push(null===i||isNaN(i)?[n,i,[i,i]]:[n,i,[r[0],r[2]]])):o.push([n,null,[null,null]]);return o},t.prototype.rollingAverage=function(t,e){e=Math.min(e,t.length);var a,n,i,r,o,l,s,h=[];for(n=0,r=0,i=0,o=0,l=0;l<t.length;l++){if(a=t[l][1],s=t[l][2],h[l]=t[l],null===a||isNaN(a)||(n+=s[0],r+=a,i+=s[1],o+=1),l-e>=0){var p=t[l-e];null===p[1]||isNaN(p[1])||(n-=p[2][0],r-=p[1],i-=p[2][1],o-=1)}h[l]=o?[t[l][0],1*r/o,[1*n/o,1*i/o]]:[t[l][0],null,[null,null]]}return h}}(),function(){"use strict";Dygraph.DataHandlers.FractionsBarsHandler=function(){};var t=Dygraph.DataHandlers.FractionsBarsHandler;t.prototype=new Dygraph.DataHandlers.BarsHandler,t.prototype.extractSeries=function(t,e,a){for(var n,i,r,o,l,s,h,p,d=[],c=100,g=a.get("sigma"),u=a.get("logscale"),y=0;y<t.length;y++)n=t[y][0],r=t[y][e],u&&null!==r&&(r[0]<=0||r[1]<=0)&&(r=null),null!==r?(o=r[0],l=r[1],null===o||isNaN(o)?d.push([n,o,[o,o,o,l]]):(s=l?o/l:0,h=l?g*Math.sqrt(s*(1-s)/l):1,p=c*h,i=c*s,d.push([n,i,[i-p,i+p,o,l]]))):d.push([n,null,[null,null,null,null]]);return d},t.prototype.rollingAverage=function(t,e,a){e=Math.min(e,t.length);var n,i,r,o,l=[],s=a.get("sigma"),h=a.get("wilsonInterval"),p=0,d=0,c=100;for(r=0;r<t.length;r++){p+=t[r][2][2],d+=t[r][2][3],r-e>=0&&(p-=t[r-e][2][2],d-=t[r-e][2][3]);var g=t[r][0],u=d?p/d:0;if(h)if(d){var y=0>u?0:u,v=d,_=s*Math.sqrt(y*(1-y)/v+s*s/(4*v*v)),f=1+s*s/d;n=(y+s*s/(2*d)-_)/f,i=(y+s*s/(2*d)+_)/f,l[r]=[g,y*c,[n*c,i*c]]}else l[r]=[g,0,[0,0]];else o=d?s*Math.sqrt(u*(1-u)/d):1,l[r]=[g,c*u,[c*(u-o),c*(u+o)]]}return l}}();
//# sourceMappingURL=dygraph-combined.min.js.map